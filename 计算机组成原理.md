# 计算机组成原理

## 一、计算机概要与技术

### 1.1 引言

分类：个人计算机，服务器，嵌入式计算机,个人移动设备（PMD），云计算
$$KB =10^3,KiB=10^{10} ;MB =10^6,MiB=10^{20}$$

### 1.2 计算机系统结构中8个伟大思想

1. 面向摩尔定律的设计
2. 使用抽象简化设计
3. 加速大概率事件
4. 通过并行提高性能
5. 通过流水线提高性能
6. 通过预测提高性能
7. 存储器层次
8. 通过冗余提高可靠性

### 1.3 程序设计入门

层次结构：硬件>系统软件>应用软件
高级语言--编译--：汇编语言--汇编--：机器语言

### 1.4 硬件概念入门

五大部分：

* 输入设备：为计算机提供信息的装置
* 输出设备：将计算结果输出给用户或其它计算机的装置
* 数据通路：在处理器中执行算术操作的部分
* 控制器：处理器中根据程序中的指令指挥数据通路、存储器和I/O设备工作的部分
* 存储器（内存）：程序运行时的存储空间，同时还存储程序运行时所需的数据。

>数据通路和控制器合称“中央处理单元”（CPU）;存储器、数据通路和控制器在信息处理操作中起主要作用，是计算机硬件的主体部分，通常被称为“主机”。

显示器
>CRT显示：阴极管电子轰击，位图显示  
>LCD显示：液晶显示，轻巧低功耗

存储设备：
高速缓存 — 主存储器 — 二级存储器

1. **主存储器**：程序运行时的存储空间，也存放需要处理的数据。也称为内存，由DRAM（动态随机访问存储器）芯片组成。  
2. **高速缓存**：作为DRAM的缓冲，解决CPU和主存之间的速度匹配。由SRAM（静态随机访问存储器）芯片组成，比DRAM 更快，集成度更低。
3. **二级存储器**：非易失性存储器
    * 磁盘
    * 闪存：PMD的二级存储器的标准

### 1.5 性能

#### 性能的定义：

* 响应时间：也叫执行时间，是计算机完成某任务所需要的总时间，包括硬盘访问、内存访问、I/O活动、操作系统开销和CPU执行时间等。PC用户感兴趣
* 吞吐率：也叫带宽（bandwidth），表示单位时间内完成的任务数量，数据中心感兴趣。

#### 性能的度量：

1. 时钟周期：CPU主频的倒数
2. CPU（执行）时间：某一任务在CPU上花费的时间；=用户CPU时间+系统CPU时间

#### CPU性能

一个程序的 CPU执行时间 = 一个程序的CPU时钟周期数/时钟频率

#### 指令性能

一个程序的CPU时钟周期数 = 程序的指令数×每条指令的平均时钟周期数
>CPI：每条指令的平均周期数，表示执行某个程序或程序片断时每条指令所需的时钟周期平均数。

#### 经典CPU性能公式

$$T_{CPU} = 指令数 \times CPI \times 时钟周期时间，（T_{CPU}为CPU时间）$$

## 二、计算机的语言

计算机中信息分为：数据信息（数值与非数值）和控制信息

### 2.1 数据信息表示方法

#### 2.1.1 进制及转换

r进制：$\sum X_i \times r^i$
十进制化为二进制：除2取余，直到被除数为0。余数倒过来
小数：乘2取整，直到小数部分为0

#### 2.1.2 机器数编码

原码：最高位为符号位，其余正常
补码：符号位可参与计算，负数补码为原码除符号位部分取反+1
>符号扩展：补码可将其符号位向前复制多次填满高位
反码：负数除原码符号位取反

#### 2.1.3 数据表示方法

1. 定点表示法
    小数点位置隐含约定，固定不变
2. 浮点表示法
    $$N=(-1)^S \times F \times 2^E$$
    如$(-1)^0\times 0.011011 \times 2^{011}$
    S为符号位；E为N的指数,或称为阶码；F为N的尾数，代表全部有效数值

    1. MIPS中浮点表示如下：
        * 单精度：

            可表示从$2.0\times 10^{-38} - 2.0\times 10^{38}$的数值

        S       |   E   |   F
        :-----: | :----:|:----:
        31(1位) |30-23(8位)|22-0(23位)

        * 双精度：

            可表示从$2.0\times 10^{-308} - 2.0\times 10^{308}$的数值

        S       |   E   |   F
        :-----: | :----:|:----:
        31(1位) |30-20(11位)|19-0

        F |
        :-----:|
        31-0(52位）|

        >科学记数法
        >其中指数均用移码表示，及补码符号位取反 $[E]_移 = E+Bias$;E为指数的真值，Bias 为偏阶，通常 $Bias= 2^n$ ，其中，n为指数的数码位位数， $2^n$ 是符号位的位权。

    2. IEEE 754浮点标准：
        $$N=(-1)^S\times (1+Fraction) \times 2^{Exponent-Bias}$$
        其中单精度的Bias为127$(2^8-1)$,双精度为1023$(2^11-1)$
        Fraction只是尾数域的值，其值在0和1之间，真正有效位的值为： 1+Fraction。（隐含尾数域前有一定点）
        Exponent是指数域的值，Exponent-Bias指明该数的小数点位置，表示数据的大小范围。
        MIPS中的表示与之前相同，只是E换成了Exponent，为无符号数，值为指数+Bias；F换成了Fraction，为小数部分-1

#### 2.1.4 字符表示方法

1. ASCII码：“美国标准信息交换代码”(American Standard Code for Information Interchange)，简称ASCII码。使用8位的字节来表示字符。
2. Unicode编码：是大多数人类语言中字母的通用编码。通常采用16位来表示一个字符。

### 2.2 MIPS指令集

#### 2.2.1 基本概念

指令集：一个给定的计算机体系结构所包含的指令集合。

存储程序：多种类型的指令和数据均以数字形式存储于存储器中。

#### 2.2.2 MIPS的操作数

1. 规定：
    算术指令操作数必须来自寄存器
    * 寄存器大小：32位
    * 寄存器个数：32个
    寄存器表示：

    名称     |寄存器号    |用途   |调用时是否保存
    :----:   | :----:    |:----: |:-----:
    $zero    | 0         |常数0  | 不适用
    \$v0~$v1 | 2~3       |计算结果|否
    \$a0~$a3 | 4~7       | 参数  | 否
    \$t0~$t7 | 8~15      | 临时变量|否
    \$s0~$s7 | 16~23     |保存的寄存器| 是
    \$t8~$t9 | 24~25     | 更多临时变量| 否
    $gp      | 28        | 全局指针 |是
    $sp      | 29        | 栈指针  | 是
    $fp      | 30        | 帧指针  | 是
    $ra      | 31        | 返回地址| 是

2. 存储器操作数

