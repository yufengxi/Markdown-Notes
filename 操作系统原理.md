# 操作系统原理

## 一、操作系统引论

1. 操作系统作用

    1. 最重要的系统软件

        * 组成：
            * 软件： 应用软件，系统软件
            * 硬件： I/O设备，存储器，处理器

    2. 系统资源管理者

        * 控制和管理计算机系统硬件和软件资源
            * 软件资源：信息（数据，程序）
            * 硬件资源： I/O设备，存储器，处理器
    3. 裸机第一层系统软件

    4. 用户与裸机间的接口
        * 作业级接口：提供一组系统命令（命令行，菜单式，命令式脚本。图形界面GUI）供用户组织操作
        * 程序级接口： 提供一组系统调用，供永和程序和其他程序调用（如MSDOS的int 21h，WINDOWS的API函数）
    5. 操作系统定义：
        一组控制和管理计算机系统软硬件资源，合理组织计算机工作流程级方便永和的程序集合

2. 操作系统目标
    * 有效性（系统管理人员）
    * 方便性（用户观点）
    * 可扩充性（系统设计员）
    * 开放性

3. 操作系统发展历史

    1. 操作系统发展动力
        1. 提高资源利用率和系统性能
        2. 方便用户
        3. 器件的发展
        4. 计算机体系结构的发展

    2. 手工操作
        * 1946-50s，晶体管，集中计算
        * 机器语言，卡片或纸带
        * 用户（即程序员）独占CPU全部资源，低效；CPU等待用户，利用率低
    3. 单道批次处理系统
        * 50s末-60s中（晶体管），人员出现分工
        * 联机批处理：
            * 用户提交作业：以纸带或卡片为介质
            * 操作员合成批作业：结果磁带介质
            * 作业构成： 程序及使用的数据以及作业控制卡说明书
            * 批作业处理：对批作业中所有作业做相同处理，读入作业，编译连接，启动执行
        * 脱机批处理：
            * 利用卫星机完成输入输出，主机完成计算  
            * 卫星机：完成面向对象的输入输出，中间结果暂存在磁带磁盘上
            * 作业控制命令由监督程序执行
            * 优点： 同一批各作业自以此更替，改善CPU和I/O的使用效率
            * 缺点：磁盘磁带需人工装卸，作业需人分类
        * 优点： 系统吞吐量大，资源利用率高
        * 缺点： 周转时间长，永和无法实现对作业控制

    4. 执行系统阶段
        * 60年代初，发展了通道技术和终端技术
        * 通道：用于控制I/O设备与内存间数据传输，启动后课与CPO并行

    5. 多道批处理系统
        * 60-70年代
        * 宏观：并行，多任务同时运行但未运行完
        * 微观：串行，个任务交替使用CPU

    6. 分时系统
        * 70年代中期至今
        * 多用户分时
        * 前台后台程序分时
        * 按时间片分配
        * 抢先式和非抢先式

    7. 实时系统

4. 操作系统基本类型
    1. 单用户系统：MS-DOS,WINDOW 95/98
    2. 多用户系统： UNIX
    3. 单任务系统： MS-DOS
    4. 多任务系统： UNIX，WINDOWS

5. f

6. 操作系统特征和功能
    1. 操作系统特征
        * 并发性
        * 共享性
        * 虚拟性
        * 异步性
    2. 现代操作系统特征：
        * 微内核结构
        * 多线程
        * 对称多处理
        * 分布式操作系统
        * 面向对象设计

## 二、进程

### 2.1 前驱图和程序进行

* 程序顺序执行的特征：顺序性，封闭性（资源状态仅能由执行程序改变），可再现性（初始条件相同，则结构唯一）
* 程序并发执行的特征：间隔性，失去封闭性，不可再现性（因此要采取措施维持可再现性）

### 2.2 进程的描述

#### 2.2.1 进程性质

* 进程的特征
    1. 动态性
    2. 并发性
    3. 独立性
    4. 异步性
    5. 结构特征（程序段，数据段，进程控制块（PCB））
* 进程的三种基本状态
    1. 运行：进程在CPU上执行
    2. 就绪：进程在内存中等待分配
    3. 阻塞：正在运行的进程收到阻塞不能执行，放弃处理器
    就绪和运行可互相转换，而运行到阻塞，阻塞到就绪是单向的过程
* 创建和终止状态：
    创建PCB -> 就绪 -> 运行 -> 终止

* 挂起操作：
    1. 引入原因：终端用户，负荷调节，操作系统的需要，父进程请求
    <img src = "./pictures/OS/OS1.png"/>

#### 2.2.2 进程数据结构

* OS中管理控制的数据结构：**内存表，设备表，文件表，进程表**。PCB是进程存在的唯一标识

* 进程控制块（PCB块）中的信息：
    1. 进程标识符：
        * 外部标识符：创建时用户指定
        * 内部标识符：OS唯一指定
    2. 处理机状态：
        * 通用寄存器，指令寄存器，程序状态字，用户栈指针
    3. 进程调度：
        * 进程状态，优先级，阻塞原因
    4. 进程控制：
        * 程序和数据地址，资源清单等
* PCB组织方式：1. 线性表 2. 链接方式 3. 索引方式

### 2.3 进程控制

管理状态/用户状态

* 内核：OS中核心功能的集合

    * 资源管理功能：进程管理，存储器管理，设备管理
    * 支持功能： 中断处理（最基本功能），时钟管理，**原语操作**（不能中断，不可分割）
* 中断：程序执行过程中

* 引起进程创建的事件：
    1. 操作系统初始化
    2. 用户登录（分时系统）
    3. 作业调度（外存-内存）
    4. 提供服务（输入/输出）
    5. 应用请求（进程自身）

* 进程的终止：
    从标识符叫所处PCB独处状态
* 进程的阻塞与唤醒：
    1. 向系统请求资源失败
    2. 等待某种操作完成
    3. 新数据尚未到来
    4. 等待新任务到达
